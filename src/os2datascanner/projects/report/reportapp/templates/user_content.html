{% load i18n %}
{% load get_settings_tag %}
{% settings_value "SAML2_ENABLED" as saml2_enabled %}

<h1 class="userprofile-text">{% trans "Account" %}</h1>

<div class="userprofile-content-wrapper user-image">
  <span class="user__avatar_verybig">
    {% if account.image %}
      <img class="userprofile-image" src="{{ account.image }}">
    {% else %}
      <i id="account_circle" class="material-icons">account_circle</i>
    {% endif %}
  </span>
</div>

<div class="userprofile-content-wrapper user-tables">
  <h2>{% trans "Account information" %}</h2>
  <table class="userprofile-table account-info">
    <tbody>
      <tr>
        <td>{% trans "Name" %}</td>
        <td>{{ account.get_full_name }}</td>
      </tr>
      <tr>
        <td>{% trans "Username" %}</td>
        <td>{{ account.username }}</td>
      </tr>
      <tr>
        <td>{% trans "E-mail" %}</td>
        <td>{{ account.email }}</td>
      </tr>
      <tr>
        <td>{% trans "Organization" %}</td>
        <td>
          {% if account.organization %}{{ account.organization }}{% endif %}
        </td>
      </tr>
      {% if account.is_manager %}
        <tr>
          <td>{% trans "Manager for" %}</td>
          <td>
            <ul>
              {% for unit in account.get_managed_units %}<li>{{ unit.name }}</li>{% endfor %}
            </ul>
          </td>
        </tr>
      {% endif %}
      {% if is_dpo %}
        <tr>
          <td>{% trans "Contact Person" %}</td>
          <td class="ds-checkbox">
            <input type="checkbox"
                   name="contact_check"
                   id="contact_check"
                   value="checked"
                   hx-post=""
                   hx-trigger="change"
                   hx-swap="afterend"
                   hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                   hx-include='#contact_check'
                   {% if is_contact_person %}checked{% endif %}>
            <label for="contact_check"
                   title="{% trans "By checking this box, users will be presented with your email address for DPO-related questions." %}">
            </label>
          </td>
        </tr>
      {% endif %}
    </tbody>
  </table>

  <h2>{% trans "User Rights" %}</h2>
  <table class="userprofile-table user-rights">
    <tbody>
      <tr>
        <td>{% trans "Roles" %}</td>
        <td>
          <ul>
            {% for role in user_roles %}<li>{{ role|capfirst }}</li>{% endfor %}
          </ul>
        </td>
      </tr>
      {% if user.is_active %}
        <tr>
          <td>{% trans "Active" %}</td>
          <td>
            <span class="checkmark true">
              {% include "components/svg-icons/check_circle_full.svg" %}
              <span class="width">{% trans "Yes" %}</span>
            </span>
          </td>
        </tr>
      {% endif %}
      {% if user.is_staff %}
        <tr>
          <td>{% trans "Staff" %}</td>
          <td>
            <span class="checkmark true">
              {% include "components/svg-icons/check_circle_full.svg" %}
              <span class="width">{% trans "Yes" %}</span>
            </span>
          </td>
        </tr>
      {% endif %}
      {% if user.is_superuser %}
        <tr>
          <td>{% trans "Superuser" %}</td>
          <td>
            <span class="checkmark true">
              {% include "components/svg-icons/check_circle_full.svg" %}
              <span class="width">{% trans "Yes" %}</span>
            </span>
          </td>
        </tr>
      {% endif %}
      <tr>
        <td>{% trans "Aliases" %}</td>
        <td>
          <ul>
            {% for alias in aliases %}<li>{{ alias.value }} ({{ alias.alias_type }})</li>{% endfor %}
          </ul>
        </td>
      </tr>
    </tbody>
  </table>

  <h2>{% trans "Login Information" %}</h2>
  <table class="userprofile-table login-info">
    <tbody>
      {% if not saml2_enabled and account == request.user.account %}
        <tr>
          <td>{% trans "Password" %}</td>
          <td>
            <a class="password-change" href="/accounts/password_change/">{% trans "Change" %}</a>
          </td>
        </tr>
      {% endif %}
      <tr>
        <td>{% trans "User since" %}</td>
        <td>{{ user.date_joined }}</td>
      </tr>
    </tbody>
  </table>
</div>
