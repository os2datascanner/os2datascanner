{% extends "partials/base.html" %}

{% load i18n %}

{% block rendertype %}regular{% endblock %}

{% block body %}
  {% include "partials/header.html" %}
  <main class="wrapper" hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
    {% include "partials/main.html" with active_tab="miniscan" %}
    <div class="content">
      <h1>{% trans "OS2datascanner mini-scanner" %}</h1>
      <p>
        {% blocktranslate trimmed %}
          The mini-scanner lets you execute any OS2datascanner rule on a single
          file, and returns the results directly to this page.
        {% endblocktranslate %}
      </p>
      <form class="form"
            role="form"
            hx-post="{% url 'miniscan_run' %}"
            hx-swap="innerHTML"
            hx-target="div#response"
            hx-encoding="multipart/form-data"
            hx-indicator="div.spinner">
        <h2>{% trans "File to scan" %}</h2>
        <input name="file" type="file" class="upload" />
        <h2>{% trans "Rule to execute" %}</h2>
        {% include "components/admin-widgets/rule-builder.html" %}
        <button class="button button--cta" type="submit" style="margin-top: 1em">{% trans "Run" %}</button>
        <h3>{% trans "Scan result" %}</h3>
        <div id="response">{% trans "(none yet)" %}</div>
      </form>
      <div class="spinner" /></div>
  </main>
{% endblock %}
